\hypertarget{namespacemolSimplify_1_1distgeom}{}\section{mol\+Simplify.\+distgeom Namespace Reference}
\label{namespacemolSimplify_1_1distgeom}\index{mol\+Simplify.\+distgeom@{mol\+Simplify.\+distgeom}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespacemolSimplify_1_1distgeom_a4acf9d8d49cd4e59048bfd34a8ca694f}{Cos\+Rule} (AB, BC, theta)
\begin{DoxyCompactList}\small\item\em Applies the cosine rule to get the length of AC given lengths of AB, BC and angle A\+BC. \end{DoxyCompactList}\item 
def \hyperlink{namespacemolSimplify_1_1distgeom_a4bc2fea7054e74224acf7455ef2457c2}{Get\+Bounds\+Matrices} (mol, natoms, \hyperlink{namespacemolSimplify_1_1distgeom_a3aab6d25e8f34a4b314e6ae3e33b5655}{catoms}=\mbox{[}$\,$\mbox{]})
\begin{DoxyCompactList}\small\item\em Generate distance bounds matrices. \end{DoxyCompactList}\item 
def \hyperlink{namespacemolSimplify_1_1distgeom_ae87d97e79600fafa6255331c1b738af6}{Triangle} (LB, UB, natoms)
\begin{DoxyCompactList}\small\item\em Triangle inequality bounds smoothing. \end{DoxyCompactList}\item 
def \hyperlink{namespacemolSimplify_1_1distgeom_aeea656ddbab4cd45d9229cf937cc5166}{Metrize} (LB, UB, natoms, Full=True)
\begin{DoxyCompactList}\small\item\em Metrization to select random in-\/range distances. \end{DoxyCompactList}\item 
def \hyperlink{namespacemolSimplify_1_1distgeom_a0e20f4ca4b2932cc006bc638df4fe07b}{Get\+C\+M\+Dists} (D, natoms)
\begin{DoxyCompactList}\small\item\em Get distances of each atom to CM given the distance matrix. \end{DoxyCompactList}\item 
def \hyperlink{namespacemolSimplify_1_1distgeom_a6d508087b38951d64ecc00438d3139d3}{Get\+Metric\+Matrix} (D, D0, natoms)
\begin{DoxyCompactList}\small\item\em Get metric matrix from distance matrix and CM distances. \end{DoxyCompactList}\item 
def \hyperlink{namespacemolSimplify_1_1distgeom_a2a9f4b671337bde3a1a15d9adef28959}{Get3\+Eigs} (G, natoms)
\begin{DoxyCompactList}\small\item\em Gets 3 largest eigenvalues and corresponding eigenvectors of metric matrix. \end{DoxyCompactList}\item 
def \hyperlink{namespacemolSimplify_1_1distgeom_a9393f464d0cdef4e6ad87bcc895767d2}{Dist\+Err} (x, args)
\begin{DoxyCompactList}\small\item\em Computes distance error function for scipy optimization. \end{DoxyCompactList}\item 
def \hyperlink{namespacemolSimplify_1_1distgeom_a6117d1a32fc76bdb45be5286ccd0f560}{Save\+Conf} (X, mol, ffclean=True, \hyperlink{namespacemolSimplify_1_1distgeom_a3aab6d25e8f34a4b314e6ae3e33b5655}{catoms}=\mbox{[}$\,$\mbox{]})
\begin{DoxyCompactList}\small\item\em Further cleans up with OB FF and saves to a new mol3D object. \end{DoxyCompactList}\item 
def \hyperlink{namespacemolSimplify_1_1distgeom_a4e88fd4f6eafcb693dfcc7cba4ee42a7}{Get\+Conf} (mol, \hyperlink{namespacemolSimplify_1_1distgeom_a3aab6d25e8f34a4b314e6ae3e33b5655}{catoms}=\mbox{[}$\,$\mbox{]})
\begin{DoxyCompactList}\small\item\em Uses distance geometry to get a random conformer. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
list \hyperlink{namespacemolSimplify_1_1distgeom_a3aab6d25e8f34a4b314e6ae3e33b5655}{catoms} = \mbox{[}7,10,18,19\mbox{]}
\item 
def \hyperlink{namespacemolSimplify_1_1distgeom_afe6a1a0b7b2279c05a6fd4ddd6364057}{conf} = \hyperlink{namespacemolSimplify_1_1distgeom_a4e88fd4f6eafcb693dfcc7cba4ee42a7}{Get\+Conf}(mol,\hyperlink{namespacemolSimplify_1_1distgeom_a3aab6d25e8f34a4b314e6ae3e33b5655}{catoms})
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{namespacemolSimplify_1_1distgeom_a4acf9d8d49cd4e59048bfd34a8ca694f}\label{namespacemolSimplify_1_1distgeom_a4acf9d8d49cd4e59048bfd34a8ca694f}} 
\index{mol\+Simplify\+::distgeom@{mol\+Simplify\+::distgeom}!Cos\+Rule@{Cos\+Rule}}
\index{Cos\+Rule@{Cos\+Rule}!mol\+Simplify\+::distgeom@{mol\+Simplify\+::distgeom}}
\subsubsection{\texorpdfstring{Cos\+Rule()}{CosRule()}}
{\footnotesize\ttfamily def mol\+Simplify.\+distgeom.\+Cos\+Rule (\begin{DoxyParamCaption}\item[{}]{AB,  }\item[{}]{BC,  }\item[{}]{theta }\end{DoxyParamCaption})}



Applies the cosine rule to get the length of AC given lengths of AB, BC and angle A\+BC. 


\begin{DoxyParams}{Parameters}
{\em AB} & Length of AB \\
\hline
{\em BC} & Length of BC \\
\hline
{\em theta} & Angle in degrees \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Length of AC 
\end{DoxyReturn}
\mbox{\Hypertarget{namespacemolSimplify_1_1distgeom_a9393f464d0cdef4e6ad87bcc895767d2}\label{namespacemolSimplify_1_1distgeom_a9393f464d0cdef4e6ad87bcc895767d2}} 
\index{mol\+Simplify\+::distgeom@{mol\+Simplify\+::distgeom}!Dist\+Err@{Dist\+Err}}
\index{Dist\+Err@{Dist\+Err}!mol\+Simplify\+::distgeom@{mol\+Simplify\+::distgeom}}
\subsubsection{\texorpdfstring{Dist\+Err()}{DistErr()}}
{\footnotesize\ttfamily def mol\+Simplify.\+distgeom.\+Dist\+Err (\begin{DoxyParamCaption}\item[{}]{x,  }\item[{}]{args }\end{DoxyParamCaption})}



Computes distance error function for scipy optimization. 

Copied from E3 in pp. 311 of ref. \mbox{[}1\mbox{]} 
\begin{DoxyParams}{Parameters}
{\em x} & 1D array of coordinates to be optimized \\
\hline
{\em $\ast$args} & Other parameters (refer to scipy.\+optimize docs) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Objective function 
\end{DoxyReturn}
\mbox{\Hypertarget{namespacemolSimplify_1_1distgeom_a2a9f4b671337bde3a1a15d9adef28959}\label{namespacemolSimplify_1_1distgeom_a2a9f4b671337bde3a1a15d9adef28959}} 
\index{mol\+Simplify\+::distgeom@{mol\+Simplify\+::distgeom}!Get3\+Eigs@{Get3\+Eigs}}
\index{Get3\+Eigs@{Get3\+Eigs}!mol\+Simplify\+::distgeom@{mol\+Simplify\+::distgeom}}
\subsubsection{\texorpdfstring{Get3\+Eigs()}{Get3Eigs()}}
{\footnotesize\ttfamily def mol\+Simplify.\+distgeom.\+Get3\+Eigs (\begin{DoxyParamCaption}\item[{}]{G,  }\item[{}]{natoms }\end{DoxyParamCaption})}



Gets 3 largest eigenvalues and corresponding eigenvectors of metric matrix. 


\begin{DoxyParams}{Parameters}
{\em G} & Metric matrix \\
\hline
{\em natoms} & Number of atoms in molecule \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Three largest eigenvalues and corresponding eigenvectors 
\end{DoxyReturn}
\mbox{\Hypertarget{namespacemolSimplify_1_1distgeom_a4bc2fea7054e74224acf7455ef2457c2}\label{namespacemolSimplify_1_1distgeom_a4bc2fea7054e74224acf7455ef2457c2}} 
\index{mol\+Simplify\+::distgeom@{mol\+Simplify\+::distgeom}!Get\+Bounds\+Matrices@{Get\+Bounds\+Matrices}}
\index{Get\+Bounds\+Matrices@{Get\+Bounds\+Matrices}!mol\+Simplify\+::distgeom@{mol\+Simplify\+::distgeom}}
\subsubsection{\texorpdfstring{Get\+Bounds\+Matrices()}{GetBoundsMatrices()}}
{\footnotesize\ttfamily def mol\+Simplify.\+distgeom.\+Get\+Bounds\+Matrices (\begin{DoxyParamCaption}\item[{}]{mol,  }\item[{}]{natoms,  }\item[{}]{catoms = {\ttfamily \mbox{[}\mbox{]}} }\end{DoxyParamCaption})}



Generate distance bounds matrices. 

The basic idea is outlined in ref \mbox{[}1\mbox{]}.

We use only 1-\/2 (bond length) and 1-\/3 (bond angle) constraints, read from the F\+F-\/optimized initial conformer.

Additionally, to bias the search towards coordinating conformers, approximate connection atom distance constraints are also included. 
\begin{DoxyParams}{Parameters}
{\em mol} & mol3D of molecule \\
\hline
{\em natoms} & Number of atoms in molecule \\
\hline
{\em catoms} & List of ligand connection atoms (default empty) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Lower and upper bounds matrices 
\end{DoxyReturn}
\mbox{\Hypertarget{namespacemolSimplify_1_1distgeom_a0e20f4ca4b2932cc006bc638df4fe07b}\label{namespacemolSimplify_1_1distgeom_a0e20f4ca4b2932cc006bc638df4fe07b}} 
\index{mol\+Simplify\+::distgeom@{mol\+Simplify\+::distgeom}!Get\+C\+M\+Dists@{Get\+C\+M\+Dists}}
\index{Get\+C\+M\+Dists@{Get\+C\+M\+Dists}!mol\+Simplify\+::distgeom@{mol\+Simplify\+::distgeom}}
\subsubsection{\texorpdfstring{Get\+C\+M\+Dists()}{GetCMDists()}}
{\footnotesize\ttfamily def mol\+Simplify.\+distgeom.\+Get\+C\+M\+Dists (\begin{DoxyParamCaption}\item[{}]{D,  }\item[{}]{natoms }\end{DoxyParamCaption})}



Get distances of each atom to CM given the distance matrix. 

Copied from ref \mbox{[}2\mbox{]}, pp. 309 
\begin{DoxyParams}{Parameters}
{\em D} & Distance matrix \\
\hline
{\em natoms} & Number of atoms in molecule \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Vector of CM distances 
\end{DoxyReturn}
\mbox{\Hypertarget{namespacemolSimplify_1_1distgeom_a4e88fd4f6eafcb693dfcc7cba4ee42a7}\label{namespacemolSimplify_1_1distgeom_a4e88fd4f6eafcb693dfcc7cba4ee42a7}} 
\index{mol\+Simplify\+::distgeom@{mol\+Simplify\+::distgeom}!Get\+Conf@{Get\+Conf}}
\index{Get\+Conf@{Get\+Conf}!mol\+Simplify\+::distgeom@{mol\+Simplify\+::distgeom}}
\subsubsection{\texorpdfstring{Get\+Conf()}{GetConf()}}
{\footnotesize\ttfamily def mol\+Simplify.\+distgeom.\+Get\+Conf (\begin{DoxyParamCaption}\item[{}]{mol,  }\item[{}]{catoms = {\ttfamily \mbox{[}\mbox{]}} }\end{DoxyParamCaption})}



Uses distance geometry to get a random conformer. 


\begin{DoxyParams}{Parameters}
{\em mol} & mol3D of molecule \\
\hline
{\em catoms} & List of connection atoms (default empty), used to generate additional constraints if specified (see \hyperlink{namespacemolSimplify_1_1distgeom_a4bc2fea7054e74224acf7455ef2457c2}{Get\+Bounds\+Matrices()}) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
mol3D of new conformer 
\end{DoxyReturn}
\mbox{\Hypertarget{namespacemolSimplify_1_1distgeom_a6d508087b38951d64ecc00438d3139d3}\label{namespacemolSimplify_1_1distgeom_a6d508087b38951d64ecc00438d3139d3}} 
\index{mol\+Simplify\+::distgeom@{mol\+Simplify\+::distgeom}!Get\+Metric\+Matrix@{Get\+Metric\+Matrix}}
\index{Get\+Metric\+Matrix@{Get\+Metric\+Matrix}!mol\+Simplify\+::distgeom@{mol\+Simplify\+::distgeom}}
\subsubsection{\texorpdfstring{Get\+Metric\+Matrix()}{GetMetricMatrix()}}
{\footnotesize\ttfamily def mol\+Simplify.\+distgeom.\+Get\+Metric\+Matrix (\begin{DoxyParamCaption}\item[{}]{D,  }\item[{}]{D0,  }\item[{}]{natoms }\end{DoxyParamCaption})}



Get metric matrix from distance matrix and CM distances. 

Copied from ref \mbox{[}1\mbox{]}, pp. 306 
\begin{DoxyParams}{Parameters}
{\em D} & Distance matrix \\
\hline
{\em D0} & Vector of CM distances \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Metric matrix 
\end{DoxyReturn}
\mbox{\Hypertarget{namespacemolSimplify_1_1distgeom_aeea656ddbab4cd45d9229cf937cc5166}\label{namespacemolSimplify_1_1distgeom_aeea656ddbab4cd45d9229cf937cc5166}} 
\index{mol\+Simplify\+::distgeom@{mol\+Simplify\+::distgeom}!Metrize@{Metrize}}
\index{Metrize@{Metrize}!mol\+Simplify\+::distgeom@{mol\+Simplify\+::distgeom}}
\subsubsection{\texorpdfstring{Metrize()}{Metrize()}}
{\footnotesize\ttfamily def mol\+Simplify.\+distgeom.\+Metrize (\begin{DoxyParamCaption}\item[{}]{LB,  }\item[{}]{UB,  }\item[{}]{natoms,  }\item[{}]{Full = {\ttfamily True} }\end{DoxyParamCaption})}



Metrization to select random in-\/range distances. 

Copied from ref \mbox{[}2\mbox{]}, pp. 253-\/254 
\begin{DoxyParams}{Parameters}
{\em LB} & Lower bounds matrix \\
\hline
{\em UB} & Upper bounds matrix \\
\hline
{\em natoms} & Number of atoms in molecule \\
\hline
{\em Full} & Full metrization (scales O(\+N$^\wedge$5), default false) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Distance matrix 
\end{DoxyReturn}
\mbox{\Hypertarget{namespacemolSimplify_1_1distgeom_a6117d1a32fc76bdb45be5286ccd0f560}\label{namespacemolSimplify_1_1distgeom_a6117d1a32fc76bdb45be5286ccd0f560}} 
\index{mol\+Simplify\+::distgeom@{mol\+Simplify\+::distgeom}!Save\+Conf@{Save\+Conf}}
\index{Save\+Conf@{Save\+Conf}!mol\+Simplify\+::distgeom@{mol\+Simplify\+::distgeom}}
\subsubsection{\texorpdfstring{Save\+Conf()}{SaveConf()}}
{\footnotesize\ttfamily def mol\+Simplify.\+distgeom.\+Save\+Conf (\begin{DoxyParamCaption}\item[{}]{X,  }\item[{}]{mol,  }\item[{}]{ffclean = {\ttfamily True},  }\item[{}]{catoms = {\ttfamily \mbox{[}\mbox{]}} }\end{DoxyParamCaption})}



Further cleans up with OB FF and saves to a new mol3D object. 

Note that distance geometry tends to produce puckered aromatic rings because of the lack of explicit impropers, see Riniker et al. J\+C\+IM (2015) 55, 2562-\/74 for details.

Hence, a FF optimization (with connection atoms constrained) is recommended to clean up the structure. 
\begin{DoxyParams}{Parameters}
{\em X} & Array of coordinates \\
\hline
{\em mol} & mol3D of original molecule \\
\hline
{\em ffclean} & Flag for OB FF cleanup (default True) \\
\hline
{\em } & \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacemolSimplify_1_1distgeom_ae87d97e79600fafa6255331c1b738af6}\label{namespacemolSimplify_1_1distgeom_ae87d97e79600fafa6255331c1b738af6}} 
\index{mol\+Simplify\+::distgeom@{mol\+Simplify\+::distgeom}!Triangle@{Triangle}}
\index{Triangle@{Triangle}!mol\+Simplify\+::distgeom@{mol\+Simplify\+::distgeom}}
\subsubsection{\texorpdfstring{Triangle()}{Triangle()}}
{\footnotesize\ttfamily def mol\+Simplify.\+distgeom.\+Triangle (\begin{DoxyParamCaption}\item[{}]{LB,  }\item[{}]{UB,  }\item[{}]{natoms }\end{DoxyParamCaption})}



Triangle inequality bounds smoothing. 

Copied from ref \mbox{[}2\mbox{]}, pp. 252-\/253

Scales O(\+N$^\wedge$3). 
\begin{DoxyParams}{Parameters}
{\em LB} & Lower bounds matrix \\
\hline
{\em UB} & Upper bounds matrix \\
\hline
{\em natoms} & Number of atoms in molecule \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Triangularized bounds matrices 
\end{DoxyReturn}


\subsection{Variable Documentation}
\mbox{\Hypertarget{namespacemolSimplify_1_1distgeom_a3aab6d25e8f34a4b314e6ae3e33b5655}\label{namespacemolSimplify_1_1distgeom_a3aab6d25e8f34a4b314e6ae3e33b5655}} 
\index{mol\+Simplify\+::distgeom@{mol\+Simplify\+::distgeom}!catoms@{catoms}}
\index{catoms@{catoms}!mol\+Simplify\+::distgeom@{mol\+Simplify\+::distgeom}}
\subsubsection{\texorpdfstring{catoms}{catoms}}
{\footnotesize\ttfamily list mol\+Simplify.\+distgeom.\+catoms = \mbox{[}7,10,18,19\mbox{]}}

\mbox{\Hypertarget{namespacemolSimplify_1_1distgeom_afe6a1a0b7b2279c05a6fd4ddd6364057}\label{namespacemolSimplify_1_1distgeom_afe6a1a0b7b2279c05a6fd4ddd6364057}} 
\index{mol\+Simplify\+::distgeom@{mol\+Simplify\+::distgeom}!conf@{conf}}
\index{conf@{conf}!mol\+Simplify\+::distgeom@{mol\+Simplify\+::distgeom}}
\subsubsection{\texorpdfstring{conf}{conf}}
{\footnotesize\ttfamily def mol\+Simplify.\+distgeom.\+conf = \hyperlink{namespacemolSimplify_1_1distgeom_a4e88fd4f6eafcb693dfcc7cba4ee42a7}{Get\+Conf}(mol,\hyperlink{namespacemolSimplify_1_1distgeom_a3aab6d25e8f34a4b314e6ae3e33b5655}{catoms})}

